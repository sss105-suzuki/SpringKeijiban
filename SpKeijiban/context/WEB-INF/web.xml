<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE web-app PUBLIC
	"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
	"http://java.sun.com/dtd/web-app_2_3.dtd">
	
<web-app>

	<servlet>
		<servlet-name>LoginServlet</servlet-name>
		<servlet-class>jp.co.soramasu.servlet.LoginServlet</servlet-class>
	</servlet>
	<servlet>
		<servlet-name>NewMessageServlet</servlet-name>
		<servlet-class>jp.co.soramasu.servlet.NewMessageServlet</servlet-class>
	</servlet>
	<servlet>
		<servlet-name>BackToBoardServlet</servlet-name>
		<servlet-class>jp.co.soramasu.servlet.BackToBoardServlet</servlet-class>
	</servlet>
	<servlet>
		<servlet-name>EditMessageServlet</servlet-name>
		<servlet-class>jp.co.soramasu.servlet.EditMessageServlet</servlet-class>
	</servlet>
	<servlet>
		<servlet-name>InputServlet</servlet-name>
		<servlet-class>jp.co.soramasu.servlet.InputServlet</servlet-class>
	</servlet>
	
	<servlet-mapping>
		<servlet-name>LoginServlet</servlet-name>
		<url-pattern>/login</url-pattern>
	</servlet-mapping>
	<servlet-mapping>
		<servlet-name>NewMessageServlet</servlet-name>
		<url-pattern>/newmessage</url-pattern>
	</servlet-mapping>
	<servlet-mapping>
		<servlet-name>BackToBoardServlet</servlet-name>
		<url-pattern>/backtoboard</url-pattern>
	</servlet-mapping>
	<servlet-mapping>
		<servlet-name>EditMessageServlet</servlet-name>
		<url-pattern>/editmessage</url-pattern>
	</servlet-mapping>
	<servlet-mapping>
		<servlet-name>InputServlet</servlet-name>
		<url-pattern>/input</url-pattern>
	</servlet-mapping>

</web-app>

<!--
■DB定義
create database keijiban encording 'EUC_JP' template template0;

create table login_tbl
(
	login_id char(5) not null,
	password varchar(20) not null,
	name varchar(20) not null,
	cpnstraint login_tbl_pkey primary key (login_id)
)
with oids;
alter table login_tbl owner to postgres;

create table message_tbl
(
	number serial not null,
	daynum date,
	message text not null,
	user_name varchar(20) not null,
	title varchar(30) not null,
	edit_pass varchar(20) not null,
	constraint message_tbl_pkey primary key(number)
)
with oids;
alter table message_tbl owner to postgres;

//テーブル作成文
create table response_tbl (
	daynum date not null,
	message text not null,
	distinationnum integer not null,
	responsenum integer not null,
	edit_pass varchar(20) not null,
	user_name varchar(20) not null,
	constraint response_tbl_pkey primary key(distinationnum, responsenum)
);

//関数作成
create OR REPLACE function getResNum(integer) returns integer as $$
	select cast(
		(select 1+(select count(responsenum) from response_tbl where distinationnum = $1)) as
		integer
	);
$$ LANGUAGE SQL;

//返信文生成
insert into response_tbl(daynum,distinationnum,responsenum,user_name,edit_pass,message) 
values ('now',<$1>,getresnum(<$1>),'<$2>','<$3>','<$4>');

 -->